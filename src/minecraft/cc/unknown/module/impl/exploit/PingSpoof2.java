package cc.unknown.module.impl.exploit;

import java.util.ArrayList;
import java.util.List;

import cc.unknown.event.impl.EventLink;
import cc.unknown.event.impl.network.PacketEvent;
import cc.unknown.module.impl.Module;
import cc.unknown.module.impl.api.Category;
import cc.unknown.module.impl.api.Info;
import cc.unknown.module.setting.impl.SliderValue;
import net.minecraft.network.Packet;

@Info(name = "PingSpoof", category = Category.Exploit)
public class PingSpoof2 extends Module {

	private SliderValue delayC = new SliderValue("Delay C", 200, 0, 500, 1);
	private SliderValue delayS = new SliderValue("Delay S", 200, 0, 500, 1);
	private final List<Packet<?>> packets = new ArrayList<>();

	public PingSpoof2() {
		this.registerSetting(delayC, delayS);
	}

	@EventLink
	public void onPacket(PacketEvent e) {
		Packet<?> p = e.getPacket();
		if (e.isSend()) {
			try {
				packets.add(p);
				e.setCancelled(true);
				Thread.sleep(delayC.getInputToLong());
			} catch (InterruptedException ignore) {

			}
		}

		if (e.isReceive()) {
			try {
				packets.add(p);
				e.setCancelled(true);
				Thread.sleep(delayS.getInputToLong());
			} catch (InterruptedException ignore) {
			}
		}
	}
}
