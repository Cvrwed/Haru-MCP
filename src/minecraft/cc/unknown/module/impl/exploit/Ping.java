package cc.unknown.module.impl.exploit;

import java.util.concurrent.ConcurrentLinkedQueue;

import cc.unknown.event.impl.EventLink;
import cc.unknown.event.impl.network.PacketEvent;
import cc.unknown.event.impl.player.TickEvent;
import cc.unknown.module.impl.Module;
import cc.unknown.module.impl.api.Category;
import cc.unknown.module.impl.api.Register;
import cc.unknown.module.setting.impl.SliderValue;
import cc.unknown.utils.network.TimedPacket;
import net.minecraft.network.Packet;

@Register(name = "Ping", category = Category.Exploit)
public class Ping extends Module {

	private final ConcurrentLinkedQueue<TimedPacket> packets = new ConcurrentLinkedQueue<>();
	private SliderValue morePing = new SliderValue("Additional Ping", 250, 0, 1000, 10);
	
	public Ping() {
		this.registerSetting(morePing);
	}

	@EventLink
	public void onTickPre(TickEvent.Pre e) {
		if (mc.player != null) {
			for (TimedPacket packet : packets) {
				if (System.currentTimeMillis() > packet.getMillis() + morePing.getInputToInt()) {
					try {
						Packet p = packet.getPacket();
						p.processPacket(mc.player.sendQueue.getNetworkManager().getNetHandler());
					} catch (Exception exception) {
						exception.printStackTrace();
					}
					packets.remove(packet);
				}
			}
		}
	}

	@EventLink
	public void onPacket(PacketEvent e) {
		if (e.isReceive()) {
			packets.add(new TimedPacket(e.getPacket(), System.currentTimeMillis()));
			getSpoof(e.getPacket());
		}
	}

	private boolean getSpoof(Packet packet) {
		if (IsPlayClientPacket(packet))
			return true;
		return false;
	}

	private boolean IsPlayClientPacket(Packet packet) {
		return (packet instanceof net.minecraft.network.play.server.SPacketSpawnObject
				|| packet instanceof net.minecraft.network.play.server.SPacketSpawnExperienceOrb
				|| packet instanceof net.minecraft.network.play.server.SPacketSpawnGlobalEntity
				|| packet instanceof net.minecraft.network.play.server.SPacketSpawnMob
				|| packet instanceof net.minecraft.network.play.server.SPacketScoreboardObjective
				|| packet instanceof net.minecraft.network.play.server.SPacketSpawnPainting
				|| packet instanceof net.minecraft.network.play.server.SPacketSpawnPlayer
				|| packet instanceof net.minecraft.network.play.server.SPacketAnimation
				|| packet instanceof net.minecraft.network.play.server.SPacketStatistics
				|| packet instanceof net.minecraft.network.play.server.SPacketBlockBreakAnim
				|| packet instanceof net.minecraft.network.play.server.SPacketSignEditorOpen
				|| packet instanceof net.minecraft.network.play.server.SPacketUpdateTileEntity
				|| packet instanceof net.minecraft.network.play.server.SPacketBlockAction
				|| packet instanceof net.minecraft.network.play.server.SPacketBlockChange
				|| packet instanceof net.minecraft.network.play.server.SPacketChat
				|| packet instanceof net.minecraft.network.play.server.SPacketTabComplete
				|| packet instanceof net.minecraft.network.play.server.SPacketMultiBlockChange
				|| packet instanceof net.minecraft.network.play.server.SPacketMaps
				|| packet instanceof net.minecraft.network.play.server.SPacketConfirmTransaction
				|| packet instanceof net.minecraft.network.play.server.SPacketCloseWindow
				|| packet instanceof net.minecraft.network.play.server.SPacketWindowItems
				|| packet instanceof net.minecraft.network.play.server.SPacketOpenWindow
				|| packet instanceof net.minecraft.network.play.server.SPacketWindowProperty
				|| packet instanceof net.minecraft.network.play.server.SPacketSetSlot
				|| packet instanceof net.minecraft.network.play.server.SPacketCustomPayload
				|| packet instanceof net.minecraft.network.play.server.SPacketUseBed
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityStatus
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityAttach
				|| packet instanceof net.minecraft.network.play.server.SPacketExplosion
				|| packet instanceof net.minecraft.network.play.server.SPacketChangeGameState
				|| packet instanceof net.minecraft.network.play.server.SPacketKeepAlive
				|| packet instanceof net.minecraft.network.play.server.SPacketChunkData
				|| packet instanceof net.minecraft.network.play.server.SPacketMapChunkBulk
				|| packet instanceof net.minecraft.network.play.server.SPacketEffect
				|| packet instanceof net.minecraft.network.play.server.SPacketEntity
				|| packet instanceof net.minecraft.network.play.server.SPacketPlayerPosLook
				|| packet instanceof net.minecraft.network.play.server.SPacketParticles
				|| packet instanceof net.minecraft.network.play.server.SPacketPlayerAbilities
				|| packet instanceof net.minecraft.network.play.server.SPacketPlayerListItem
				|| packet instanceof net.minecraft.network.play.server.SPacketDestroyEntities
				|| packet instanceof net.minecraft.network.play.server.SPacketRemoveEntityEffect
				|| packet instanceof net.minecraft.network.play.server.SPacketRespawn
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityHeadLook
				|| packet instanceof net.minecraft.network.play.server.SPacketHeldItemChange
				|| packet instanceof net.minecraft.network.play.server.SPacketDisplayScoreboard
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityMetadata
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityVelocity
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityEquipment
				|| packet instanceof net.minecraft.network.play.server.SPacketSetExperience
				|| packet instanceof net.minecraft.network.play.server.SPacketUpdateHealth
				|| packet instanceof net.minecraft.network.play.server.SPacketTeams
				|| packet instanceof net.minecraft.network.play.server.SPacketUpdateScore
				|| packet instanceof net.minecraft.network.play.server.SPacketSpawnPosition
				|| packet instanceof net.minecraft.network.play.server.SPacketTimeUpdate
				|| packet instanceof net.minecraft.network.play.server.SPacketUpdateSign
				|| packet instanceof net.minecraft.network.play.server.SPacketSoundEffect
				|| packet instanceof net.minecraft.network.play.server.SPacketCollectItem
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityTeleport
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityProperties
				|| packet instanceof net.minecraft.network.play.server.SPacketEntityEffect
				|| packet instanceof net.minecraft.network.play.server.SPacketCombatEvent
				|| packet instanceof net.minecraft.network.play.server.SPacketServerDifficulty
				|| packet instanceof net.minecraft.network.play.server.SPacketCamera
				|| packet instanceof net.minecraft.network.play.server.SPacketWorldBorder
				|| packet instanceof net.minecraft.network.play.server.SPacketTitle
				|| packet instanceof net.minecraft.network.play.server.SPacketSetCompressionLevel
				|| packet instanceof net.minecraft.network.play.server.SPacketPlayerListHeaderFooter
				|| packet instanceof net.minecraft.network.play.server.SPacketResourcePackSend
				|| packet instanceof net.minecraft.network.play.server.SPacketUpdateEntityNBT);
	}
}
